The code u^dated from main
